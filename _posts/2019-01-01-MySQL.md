---
title: "MySQL 学习日志"
excerpt: "MySQL"
# classes: wide
categories:
-   Coding
tags:
-   MySQL
create_at: 2019-01-01
last_modified_at: 2020-05-25
toc: true
toc_label: "文章提纲"
toc_icon: "book-reader"
toc_sticky: true
---

## errors

### timezone

-   MySQL 8.0 加入对 UTC 支持后，连接会出错，可以使用 Custom 方式输入连接串，在连接串的最后加入 `?serverTimezone=UTC` 即可
    -   完整连接串：`jdbc: mysql://localhost:3306/mysql?serverTimezone=UTC `

### 1206

1206 - The total number of locks exceeds the lock table size

问题：因为数据量太大，无法完成数据库操作

解决办法 1：

进入 MySQL 的 Command Line

输入 `show variables like "%_buffer%";`

默认的 `innodb_buffer_pool_size=8388608` 8M

修改为 `SET GLOBAL innodb_buffer_pool_size=1073741824` 1G

解决办法 2：

前面的修改是临时的，如果需要永久修改，可以去 my.ini 文件中修改

可以通过 services.msc 找到 my.ini 的位置，打开后直接修改需要的目标数据，然后重启服务就可以了。

【注】：在 Windows 下不要使用 Notepad 修改，否则文件格式会变成 UTF-8 with BOM 格式，格式改变后会导致服务无法正常启动！

### 1130

ERROR 1130: Host is not allowed to connect to this MySQL server

问题：访问别的机器的 MySQL Server 被拒绝

解决办法：

```SQL
CREATE USER 'vScopeUserName'@'localhost' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON *.* TO 'vScopeUserName'@'localhost' WITH GRANT OPTION;
CREATE USER 'vScopeUserName'@'vScopeServerIP' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON *.* TO 'vScopeUserName'@'vScopeServerIP' WITH GRANT OPTION;
FLUSH PRIVILEGES;
```

代码说明

-   vScopeUserName：希望创建的超级用户的名称，与最初的 `root` 名称不同。
-   localhost：就是本地地址。
-   vScopeServerIP：希望远程访问服务器的 IP 地址
-   password：希望使用的密码

注：本质就是对 MySQL 的 `user` 表增加一个用户，并且赋予权限，熟悉的话，可以直接对 `user` 表进行数据操作，操作完成后需要重启数据库才能有效。

## Server

### Startup & Shutdown

使用 Windows Service 启动 和 停止

```bat
REM mysql80 是服务名称
net start mysql80
net stop mysql80
```

使用 Command Line 启动 和 停止

```bat
cd C: \Program Files\MySQL\MySQL Server 8.0\bin
mysqld --defaults-file="C: \ProgramData\MySQL\MySQL Server 8.0\my.ini"
mysqladmin shutdown -u root -p
REM mysqladmin 可以查看帮助文件
```

### Data Transfer

使用文件拷贝的方式就不用再尝试了，可能以前的版本学可以，后面因为安全的需要只会越来越难。建议使用 Navicat 工具完成数据迁移。